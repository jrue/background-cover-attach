/* bgCoverAttach.js -- By Jeremy Rue (http://jeremyrue.com/) Copyright (c) 2012 The Regents of the University of California Released under the GPL Version 2 license */
(function(a){a.bgCoverAttach=function(e,c){var b=a(e),e=e,h={};var g={parentelm:a(e).parent(),top:b.css("top"),left:b.css("left")};var f=this;f.settings={};f.init=function(){f.settings=a.extend({},g,c);var i=f.settings.parentelm.css("background-image").slice(4,-1);var k=new Image();var j=j||{error:function(){}};if(f.settings.parentelm.css("background-size")!="cover"){j.error("This plugin only works with the containing element has background-size:cover");return false}if(typeof i!=="string"){j.error("No background image found on parent element");return false}if(f.settings.top=="auto"||f.settings.left=="auto"){j.error("#"+b.attr("id")+" needs CSS values for 'top' and 'left'");return false}a(k).on("load",function(){h.width=this.width;h.height=this.height;d(h.width,h.height)});a(window).on("resize",function(){if("width" in h&&h.width!=0){d(h.width,h.height)}});k.src=i};var d=function(j,k){var i=f.settings.parentelm.width()/j,m=f.settings.parentelm.height()/k,l=i>m?i:m;b.css({top:parseInt(f.settings.top,10)*l,left:parseInt(f.settings.left,10)*l})};f.init()};a.fn.bgCoverAttach=function(b){return this.each(function(){if(undefined==a(this).data("bgCoverAttach")){var c=new a.bgCoverAttach(this,b);a(this).data("bgCoverAttach",c)}})}})(jQuery);